<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2016-11-01 Tue 10:45 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title></title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Bob Mottram" />
<meta name="description" content="Turn the Beaglebone Black into a personal communications server"
 />
<meta name="keywords" content="freedombox, debian, beaglebone, hubzilla, email, web server, home server, internet, censorship, surveillance, social network, irc, jabber" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="freedombone.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<a name="top" id="top"></a>
</div>
<div id="content">
<div class="org-center">

<div class="figure">
<p><img src="images/logo.png" alt="logo.png" />
</p>
</div>
</div>

<center>
<h1>Email</h1>
</center>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><a href="#orgf390222">Things to be aware of</a></td>
</tr>

<tr>
<td class="org-left"><a href="#orgffdc116">A technical note about email transport security</a></td>
</tr>

<tr>
<td class="org-left"><a href="#org228d2f2">Add a password to your GPG key</a></td>
</tr>

<tr>
<td class="org-left"><a href="#org249b852">Publishing your GPG public key</a></td>
</tr>

<tr>
<td class="org-left"><a href="#org9aa5b3b">Mutt email client</a></td>
</tr>

<tr>
<td class="org-left"><a href="#orgd5df7da">Thunderbird/Icedove</a></td>
</tr>

<tr>
<td class="org-left"><a href="#org746ae3d">K9 Android client</a></td>
</tr>

<tr>
<td class="org-left"><a href="#orge7d90d2">Subscribing to mailing lists</a></td>
</tr>

<tr>
<td class="org-left"><a href="#org7a22eb8">Adding email addresses to a group/folder</a></td>
</tr>

<tr>
<td class="org-left"><a href="#orgf579e55">Ignoring incoming emails</a></td>
</tr>

<tr>
<td class="org-left"><a href="#orgf2e8d68">Your own mailing list</a></td>
</tr>
</tbody>
</table>

<div id="outline-container-orgf390222" class="outline-2">
<h2 id="orgf390222">Things to be aware of</h2>
<div class="outline-text-2" id="text-orgf390222">
<p>
Even though this system makes it easy to set up an email server, running your own email system is still not easy and this is mainly due to the huge amount of collatoral damage caused by spammers over a long period of time, which in turn is due to the inherent insecurity of email protocols which enabled spam to become a big problem. Email is still very popular though and most internet services require that you have an email address in order to register.
</p>

<p>
In using an email address hosted on your own system you will quite likely find that it is blocked and bounced by other popular email systems. Such blocking is almost never based upon any evidence that your system is actually producing spam and usually it's just because your IP address happens to be within a certain range.  Rather arrogantly many of the anti-spam rule sets assume that if an email is sent from an IP address range which is "residential" (i.e. not a company or other organisation) then <i>it must therefore be spam</i>.
</p>

<p>
So if you want to use your own email address hosted on your own system you do need to be prepared to encounter some difficulties and annoyances. Sadly, often these annoyances will be unsolvable and are not a matter of using different software or configuring things differently.
</p>
</div>
</div>
<div id="outline-container-orgffdc116" class="outline-2">
<h2 id="orgffdc116">A technical note about email transport security</h2>
<div class="outline-text-2" id="text-orgffdc116">
<p>
Port 465 is used for SMTP and this is supposedly deprecated for secure email. However, using TLS from the start of the communications seems far more secure than starting off with insecure communications and then trying to upgrade it with a command to begin TLS, as happens with STARTTLS. There are <a href="https://www.eff.org/deeplinks/2014/11/starttls-downgrade-attacks">possible attacks against STARTTLS</a> in which the command to begin secure communications is removed or overwritten which could then result in email being transferred in plain text over the internet and be readable by third parties.
</p>

<p>
From <a href="https://motherboard.vice.com/read/email-encryption-is-broken">https://motherboard.vice.com/read/email-encryption-is-broken</a>:
</p>

<blockquote>
<p>
The researchers also uncovered mass scale attacks of STARTTLS sessions being stripped of their encryption. That attack itself isn't new: internet service providers sometimes do it to monitor users; organizations may use it to keep an eye on employees; or it may come from a malicious actor
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org228d2f2" class="outline-2">
<h2 id="org228d2f2">Add a password to your GPG key</h2>
<div class="outline-text-2" id="text-org228d2f2">
<p>
If you didn't use existing GPG keys during the Freedombone installation then you'll need to add a password to your newly generated private key. This is highly recommended. Go through the following sequence of commands to ssh into the Freedombone and then change your GPG password.
</p>

<div class="org-src-container">
<pre class="src src-bash">ssh username@domainname -p 2222
gpg --edit-key username@domain
passwd
save
quit
<span class="org-keyword">exit</span>
</pre>
</div>

<p>
Having a password on your GPG key will prevent someone from reading your email <i>even if your server gets lost or stolen</i> or if someone else has physical access to it. Make the password something long and unlikely to be guessable or vulnerable to a brute force <a href="https://en.wikipedia.org/wiki/Dictionary_attack">dictionary attack</a>.
</p>
</div>
</div>

<div id="outline-container-org249b852" class="outline-2">
<h2 id="org249b852">Publishing your GPG public key</h2>
<div class="outline-text-2" id="text-org249b852">
<p>
If you havn't already then you should publish your GPG public key so that others can find it.
</p>

<div class="org-src-container">
<pre class="src src-bash">ssh username@domainname -p 2222
gpg --send-keys username@domainname
<span class="org-keyword">exit</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9aa5b3b" class="outline-2">
<h2 id="org9aa5b3b">Mutt email client</h2>
<div class="outline-text-2" id="text-org9aa5b3b">
<div class="org-center">

<div class="figure">
<p><img src="./images/mutt.jpeg" alt="mutt.jpeg" />
</p>
</div>
</div>

<p>
Mutt is a terminal based email client which comes already installed onto the Freedombone. To access it you'll need to access it via ssh with:
</p>

<div class="org-src-container">
<pre class="src src-bash">ssh username@domainname -p 2222
</pre>
</div>

<p>
If you're using Windows there is an ssh client called putty, on Linux just open a terminal and enter the above command with your username and domain name. On Android you can use the ConnectBot app with the hostname <b>username@domain:2222</b>
</p>

<p>
Once you have logged in via ssh then just type <b>mutt</b>. Like most terminal programs mutt is quite easy once you've learned the main keys.
</p>

<p>
Some useful keys to know are:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">"/"</td>
<td class="org-left">Search for text within headers</td>
</tr>

<tr>
<td class="org-left">*</td>
<td class="org-left">Move to the last message</td>
</tr>

<tr>
<td class="org-left">TAB</td>
<td class="org-left">Move to the next unread message</td>
</tr>

<tr>
<td class="org-left">d</td>
<td class="org-left">Delete a message</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">Undelete a mail which is pending deletion</td>
</tr>

<tr>
<td class="org-left">$</td>
<td class="org-left">Delete all messages selected and check for new messages</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">Add to the address book</td>
</tr>

<tr>
<td class="org-left">m</td>
<td class="org-left">Send a new mail</td>
</tr>

<tr>
<td class="org-left">ESC-m</td>
<td class="org-left">Mark all messages as having been read</td>
</tr>

<tr>
<td class="org-left">S</td>
<td class="org-left">Mark a message as spam</td>
</tr>

<tr>
<td class="org-left">H</td>
<td class="org-left">Mark a message as ham</td>
</tr>

<tr>
<td class="org-left">CTRL-b</td>
<td class="org-left">Toggle side bar on/off</td>
</tr>

<tr>
<td class="org-left">CTRL-n</td>
<td class="org-left">Next mailbox (on side bar)</td>
</tr>

<tr>
<td class="org-left">CTRL-p</td>
<td class="org-left">Previous mailbox (on side bar)</td>
</tr>

<tr>
<td class="org-left">CTRL-o</td>
<td class="org-left">Open mailbox (on side bar)</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">Reply to an email</td>
</tr>

<tr>
<td class="org-left">L</td>
<td class="org-left">Reply to a mailing list email</td>
</tr>

<tr>
<td class="org-left">]</td>
<td class="org-left">Expand or collapse all threads</td>
</tr>

<tr>
<td class="org-left">[</td>
<td class="org-left">Expand of collapse the current thread</td>
</tr>

<tr>
<td class="org-left">CTRL-k</td>
<td class="org-left">Import a PGP/GPG public key</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">View current email in different formats, such as HTML</td>
</tr>

<tr>
<td class="org-left">CTRL-u</td>
<td class="org-left">View long URLs</td>
</tr>

<tr>
<td class="org-left">q</td>
<td class="org-left">Quit</td>
</tr>
</tbody>
</table>

<p>
To use the address book system open an email by pressing the enter key on it and then to add the sender to the address list press the A key.  It will ask you for an alias which may be used the next time you want to send a mail.  Alternatively you may just edit the <b>~/.mutt-alias</b> file directly to add email addresses.
</p>

<p>
One of the most common things which you might wish to do is to send an email.  To do this first press <i>m</i> to create a new message.  Enter the address to send to and the subject, then after a few seconds the Emacs editor will appear with a blank document.  Type your email then press <i>CTRL-x CTRL-s</i> to save it and <i>CTRL-x CTRL-c</i> to exit.  You will then see a summary of the email to be sent out.  Press <i>y</i> to send it and then enter your GPG key passphrase (the one you gave when creating a PGP/GPG key).  The purpose of that is to add a signature which is a strong proof that the email was written by you and not by someone else.
</p>

<p>
When reading emails you will initially need to enter your GPG password. It will be retained in RAM for a while afterwards.
</p>

<p>
There is one irksome thing about email within mutt, and that's if you get sent a confirmation with a very long URL. It's usually not possible to view URLs which span over multiple lines, and trying to copy/paste them is annoying. A solution is to use <i>CTRL-u</i> then select the url and press Enter. You can then navigate to it via the lynx browser.
</p>
</div>
</div>

<div id="outline-container-orgd5df7da" class="outline-2">
<h2 id="orgd5df7da">Thunderbird/Icedove</h2>
<div class="outline-text-2" id="text-orgd5df7da">
<p>
Another common way in which you may want to access email is via Thunderbird (also known as Icedove on Debian).  This may be especially useful if you're trying to convert former Windows users who may previously have been using some version of Outlook.
</p>

<p>
The following instructions should be carried out on the client machines (laptop, etc), not on the BBB itself.
</p>
</div>

<div id="outline-container-org514a92b" class="outline-4">
<h4 id="org514a92b">Initial setup</h4>
<div class="outline-text-4" id="text-org514a92b">
<p>
Install <b>Thunderbird</b> and <b>Enigmail</b>.  How you do this just depends upon your distro and software manager or "app store".
</p>

<p>
Open Thinderbird
</p>

<p>
Select "<b>Skip this and use existing email</b>"
</p>

<p>
Enter your name, email address (myusername@mydomainname.com) and the password for your user.
</p>

<p>
You'll get a message saying "<i>Thunderbird failed to find the settings</i>"
</p>

<p>
The settings should be as follows, substituting <i>mydomainname.com</i> for your domain name and <i>myusername</i> for the username.
</p>

<ul class="org-ul">
<li>Incoming: IMAP, mydomainname.com, 993, SSL/TLS, Normal Password</li>
<li>Outgoing: SMTP, mydomainname.com, 465, SSL/TLS, Normal Password</li>
<li>Username: myusername</li>
</ul>

<p>
Click <b>Done</b>.
</p>

<p>
Click <b>Get Certificate</b> and make sure "<b>permanently store this exception</b>" is selected", then click <b>Store Security Exception</b>.
</p>

<p>
From OpenPGP setup select "<b>Yes, I would like the wizard to get me started</b>".  If the wizard doesn't start automatically then "setup wizard" can be selected from OpenPGP on the menu bar.
</p>

<p>
Select "<b>Yes, I want to sign all of my email</b>"
</p>

<p>
Select "<b>No, I will create per-recipient rules</b>"
</p>

<p>
Select "<b>yes</b>" to change default settings.
</p>
</div>
</div>
<div id="outline-container-org012e13a" class="outline-4">
<h4 id="org012e13a">Import your GPG keys</h4>
<div class="outline-text-4" id="text-org012e13a">
<p>
On the Freedombone export your GPG public and private keys.
</p>

<div class="org-src-container">
<pre class="src src-bash">ssh username@domainname -p 2222
gpg --list-keys username@domainname
gpg --output ~/public_key.gpg --armor --export KEY_ID
gpg --output ~/private_key.gpg --armor --export-secret-key KEY_ID
</pre>
</div>

<p>
On your laptop or desktop you can import the keys with:
</p>

<div class="org-src-container">
<pre class="src src-bash">scp -P 2222 username@domain:/home/username/*.gpg ~/
</pre>
</div>

<p>
Select "<b>I have existing public and private keys</b>".
</p>

<p>
Select your public and private GPG exported key files.
</p>

<p>
Select the account which you want to use and click <b>Next</b>, <b>Next</b> and <b>Finish</b>.
</p>

<p>
Remove your exported key files, both on your laptop/desktop and also on the Freedombone.
</p>

<div class="org-src-container">
<pre class="src src-bash">shred -zu ~/public_key.gpg
shred -zu ~/private_key.gpg
</pre>
</div>
</div>
</div>

<div id="outline-container-org66bb228" class="outline-4">
<h4 id="org66bb228">Using for the first time</h4>
<div class="outline-text-4" id="text-org66bb228">
<p>
Click on the Thunderbird menu, which looks like three horizontal bars on the right hand side.
</p>

<p>
Hover over <b>preferences</b> and then <b>Account settings</b>.
</p>

<p>
Select <b>OpenPGP Security</b> and make sure that <b>use PGP/MIME by default</b> is ticked. This will enable you to sign/encrypt attachments, HTML bodies and UTF-8 without any problems.
</p>

<p>
Select <b>Synchronization &amp; Storage</b>.
</p>

<p>
Make sure that <b>Keep messages for this account on this computer</b> is unticked, then click <b>Ok</b>.
</p>

<p>
Click on <b>Inbox</b>.  Depending upon how much email you have it may take a while to import the subject lines.
</p>

<p>
Note that when sending an email for the first time you will also need to accept the SSL certificate.
</p>

<p>
Get into the habit of using email encryption and encourage others to do so.  Remember that you may not think that your emails are very interesting but the Surveillance State is highly interested in them and will be actively trying to data mine your private life looking for "suspicious" patterns, regardless of whether you are guilty of any crime or not.
</p>
</div>
</div>

<div id="outline-container-org83cef94" class="outline-4">
<h4 id="org83cef94">Making folders visible</h4>
<div class="outline-text-4" id="text-org83cef94">
<p>
By default you won't be able to see any folders which you may have created earlier using the <i>mailinglistrule</i> script.  To make folders visible select:
</p>

<p>
<b>Menu</b>, hover over <b>Preferences</b>, select <b>Account Settings</b>, select <b>Server Settings</b> then click on the <b>Advanced</b> button.
</p>

<p>
Make sure that "<b>show only subscribed folders</b>" is not checked.  Then click the <b>ok</b> buttons.  Folders will be re-scanned, which may take some time depending upon how much email you have, but your folders will then appear.
</p>
</div>
</div>
</div>

<div id="outline-container-org746ae3d" class="outline-2">
<h2 id="org746ae3d">K9 Android client</h2>
<div class="outline-text-2" id="text-org746ae3d">
</div><div id="outline-container-org6bd67f0" class="outline-4">
<h4 id="org6bd67f0">A point about GPG on Android</h4>
<div class="outline-text-4" id="text-org6bd67f0">
<p>
Before trying to set up email on Android you may want to consider whether you really need to do this. Android (and its variants) is not a particularly secure operating system and whether or not you wish to store GPG keys on it depends on your threat model and in what situations you'll be using your device.
</p>

<p>
If you are going to use email on an Android device then ensure that you have full encryption enabled via the security settings, so that if you subsequently lose it, or if it gets stolen, the chances of encryption keys being exposed are minimised.
</p>
</div>
</div>
<div id="outline-container-org107e90b" class="outline-4">
<h4 id="org107e90b">Compiling the development version</h4>
<div class="outline-text-4" id="text-org107e90b">
<p>
To get K9 working with Freedombone you'll need to install development versions of OpenKeychain and K9. At the time of writing the versions available in F-Droid do not support PGP/MIME or the "hidden recipient" feature of GPG. It is hoped that at some stage the patches will be integrated into the mainline or functionally equivalent changes made. Admittedly, this is not at all user friendly, but currently it's the only way to read Freedombone email on Android systems.
</p>

<p>
Build script for OpenKeychain:
</p>

<div class="org-src-container">
<pre class="src src-bash">mkdir ~/develop
<span class="org-builtin">cd</span> ~/develop
git clone https://github.com/bashrc/open-keychain
<span class="org-builtin">cd</span> open-keychain
git checkout origin/bashrc/hidden-recipient-minimal
git checkout -b bashrc/hidden-recipient-minimal
<span class="org-builtin">cd</span> tools
nano build.sh
</pre>
</div>

<p>
Then add the following:
</p>

<div class="org-src-container">
<pre class="src src-bash"><span class="org-comment-delimiter">#</span><span class="org-comment">!/bin/</span><span class="org-keyword">bash</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">This script is intended to be used on Debian systems for building</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">the project. It has been tested with Debian 8</span>

<span class="org-variable-name">USERNAME</span>=$<span class="org-variable-name">USER</span>
<span class="org-variable-name">SIGNING_NAME</span>=<span class="org-string">'openkeychain'</span>
<span class="org-variable-name">SDK_VERSION</span>=<span class="org-string">'r23.3.4'</span>
<span class="org-variable-name">SDK_DIR</span>=$<span class="org-variable-name">HOME</span>/android-sdk

<span class="org-builtin">cd</span> ..

<span class="org-variable-name">PROJECT_HOME</span>=$(<span class="org-sh-quoted-exec">pwd</span>)

sudo apt-get install build-essential default-jdk <span class="org-sh-escaped-newline">\</span>
     lib32stdc++6 lib32z1 lib32z1-dev

<span class="org-keyword">if</span> [ <span class="org-negation-char">!</span> -d $<span class="org-variable-name">SDK_DIR</span> ]; <span class="org-keyword">then</span>
    mkdir -p $<span class="org-variable-name">SDK_DIR</span>
<span class="org-keyword">fi</span>
<span class="org-builtin">cd</span> $<span class="org-variable-name">SDK_DIR</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">download the SDK</span>
<span class="org-keyword">if</span> [[ <span class="org-negation-char">!</span> -f $<span class="org-variable-name">SDK_DIR</span>/android-sdk_$<span class="org-variable-name">SDK_VERSION</span>-linux.tgz ]]; <span class="org-keyword">then</span>
    wget https://dl.google.com/android/android-sdk_$<span class="org-variable-name">SDK_VERSION</span>-linux.tgz
<span class="org-keyword">fi</span>
tar -xzvf android-sdk_$<span class="org-variable-name">SDK_VERSION</span>-linux.tgz
<span class="org-variable-name">SDK_DIR</span>=$<span class="org-variable-name">SDK_DIR</span>/android-sdk-linux

<span class="org-builtin">echo</span> <span class="org-string">'Check that you have the SDK tools installed for Android 22, SDK 21.1.2'</span>

<span class="org-builtin">export</span> <span class="org-variable-name">ANDROID_HOME</span>=$<span class="org-variable-name">SDK_DIR</span>
<span class="org-builtin">echo</span> <span class="org-string">"sdk.dir=$SDK_DIR"</span> &gt; $<span class="org-variable-name">ANDROID_HOME</span>/local.properties
<span class="org-builtin">export</span> <span class="org-variable-name">PATH</span>=${<span class="org-variable-name">PATH</span>}:$<span class="org-variable-name">ANDROID_HOME</span>/tools:$<span class="org-variable-name">ANDROID_HOME</span>/platform-tools

<span class="org-builtin">cd</span> $<span class="org-variable-name">SDK_DIR</span>/tools
./android sdk

<span class="org-keyword">if</span> [ <span class="org-negation-char">!</span> -f $<span class="org-variable-name">SDK_DIR</span>/tools/android ]; <span class="org-keyword">then</span>
    <span class="org-builtin">echo</span> <span class="org-string">"$SDK_DIR/tools/android not found"</span>
    <span class="org-keyword">exit</span> -1
<span class="org-keyword">fi</span>
<span class="org-builtin">cd</span> $<span class="org-variable-name">SDK_DIR</span>
chmod -R 0755 $<span class="org-variable-name">SDK_DIR</span>
chmod a+rx $<span class="org-variable-name">SDK_DIR</span>/tools

<span class="org-comment-delimiter"># </span><span class="org-comment">android sdk</span>
<span class="org-builtin">cd</span> $<span class="org-variable-name">PROJECT_HOME</span>
git submodule init &amp;&amp; git submodule update

<span class="org-keyword">if</span> [ <span class="org-negation-char">!</span> -f $<span class="org-variable-name">SDK_DIR</span>/tools/templates/gradle/wrapper/gradlew ]; <span class="org-keyword">then</span>
    <span class="org-builtin">echo</span> <span class="org-string">"$SDK_DIR/tools/templates/gradle/wrapper/gradlew not found"</span>
    <span class="org-keyword">exit</span> -2
<span class="org-keyword">fi</span>
<span class="org-builtin">.</span> $<span class="org-variable-name">PROJECT_HOME</span>/gradlew assembleDebug

<span class="org-comment-delimiter"># </span><span class="org-comment">cleaning up</span>
<span class="org-builtin">cd</span> $<span class="org-variable-name">PROJECT_HOME</span>/OpenKeychain/build/outputs/apk
<span class="org-keyword">if</span> [ <span class="org-negation-char">!</span> -f OpenKeychain-debug.apk ]; <span class="org-keyword">then</span>
    <span class="org-builtin">echo</span> <span class="org-string">'OpenKeychain-debug.apk was not found'</span>
    <span class="org-keyword">exit</span> -3
<span class="org-keyword">fi</span>

<span class="org-builtin">echo</span> <span class="org-string">'Build script ended successfully'</span>
<span class="org-builtin">echo</span> -n <span class="org-string">'apk is available at: '</span>
<span class="org-builtin">echo</span> <span class="org-string">"$PROJECT_HOME/OpenKeychain/build/outputs/apk/OpenKeychain-debug.apk"</span>
<span class="org-keyword">exit</span> 0
</pre>
</div>

<p>
Save and exit with <b>CTRL-o</b>, <b>CTRL-x</b>.
</p>

<div class="org-src-container">
<pre class="src src-bash">chmod +x build.sh
./build.sh
</pre>
</div>

<p>
Build script for K9:
</p>

<div class="org-src-container">
<pre class="src src-bash"><span class="org-builtin">cd</span> ~/develop
git clone https://github.com/k9mail/k-9
<span class="org-builtin">cd</span> k-9
<span class="org-builtin">cd</span> tools
nano build.sh
</pre>
</div>

<p>
Then add the following:
</p>

<div class="org-src-container">
<pre class="src src-bash"><span class="org-comment-delimiter">#</span><span class="org-comment">!/bin/</span><span class="org-keyword">bash</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">This script is intended to be used on Debian systems for building</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">the project. It has been tested with Debian 8</span>

<span class="org-variable-name">USERNAME</span>=$<span class="org-variable-name">USER</span>
<span class="org-variable-name">SIGNING_NAME</span>=<span class="org-string">'k-9'</span>
<span class="org-variable-name">SDK_VERSION</span>=<span class="org-string">'r24.3.3'</span>
<span class="org-variable-name">SDK_DIR</span>=$<span class="org-variable-name">HOME</span>/android-sdk

<span class="org-builtin">cd</span> ..

<span class="org-variable-name">PROJECT_HOME</span>=$(<span class="org-sh-quoted-exec">pwd</span>)

sudo apt-get install build-essential default-jdk <span class="org-sh-escaped-newline">\</span>
     lib32stdc++6 lib32z1 lib32z1-dev

<span class="org-keyword">if</span> [ <span class="org-negation-char">!</span> -d $<span class="org-variable-name">SDK_DIR</span> ]; <span class="org-keyword">then</span>
    mkdir -p $<span class="org-variable-name">SDK_DIR</span>
<span class="org-keyword">fi</span>
<span class="org-builtin">cd</span> $<span class="org-variable-name">SDK_DIR</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">download the SDK</span>
<span class="org-keyword">if</span> [ <span class="org-negation-char">!</span> -f $<span class="org-variable-name">SDK_DIR</span>/android-sdk_$<span class="org-variable-name">SDK_VERSION</span>-linux.tgz ]; <span class="org-keyword">then</span>
    wget https://dl.google.com/android/android-sdk_$<span class="org-variable-name">SDK_VERSION</span>-linux.tgz
    tar -xzvf android-sdk_$<span class="org-variable-name">SDK_VERSION</span>-linux.tgz
<span class="org-keyword">fi</span>
<span class="org-variable-name">SDK_DIR</span>=$<span class="org-variable-name">SDK_DIR</span>/android-sdk-linux

<span class="org-builtin">echo</span> <span class="org-string">'Check that you have the SDK tools installed for Android 17, SDK 19.1'</span>
<span class="org-keyword">if</span> [ <span class="org-negation-char">!</span> -f $<span class="org-variable-name">SDK_DIR</span>/tools/android ]; <span class="org-keyword">then</span>
    <span class="org-builtin">echo</span> <span class="org-string">"$SDK_DIR/tools/android not found"</span>
    <span class="org-keyword">exit</span> -1
<span class="org-keyword">fi</span>
<span class="org-builtin">cd</span> $<span class="org-variable-name">SDK_DIR</span>
chmod -R 0755 $<span class="org-variable-name">SDK_DIR</span>
chmod a+rx $<span class="org-variable-name">SDK_DIR</span>/tools

<span class="org-variable-name">ANDROID_HOME</span>=$<span class="org-variable-name">SDK_DIR</span>
<span class="org-builtin">echo</span> <span class="org-string">"sdk.dir=$SDK_DIR"</span> &gt; $<span class="org-variable-name">ANDROID_HOME</span>/local.properties
<span class="org-variable-name">PATH</span>=${<span class="org-variable-name">PATH</span>}:$<span class="org-variable-name">ANDROID_HOME</span>/tools:$<span class="org-variable-name">ANDROID_HOME</span>/platform-tools

android sdk
<span class="org-builtin">cd</span> $<span class="org-variable-name">PROJECT_HOME</span>

<span class="org-keyword">if</span> [ <span class="org-negation-char">!</span> -f $<span class="org-variable-name">SDK_DIR</span>/tools/templates/gradle/wrapper/gradlew ]; <span class="org-keyword">then</span>
    <span class="org-builtin">echo</span> <span class="org-string">"$SDK_DIR/tools/templates/gradle/wrapper/gradlew not found"</span>
    <span class="org-keyword">exit</span> -2
<span class="org-keyword">fi</span>
<span class="org-builtin">.</span> $<span class="org-variable-name">PROJECT_HOME</span>/gradlew assembleDebug

<span class="org-comment-delimiter"># </span><span class="org-comment">cleaning up</span>
<span class="org-builtin">cd</span> $<span class="org-variable-name">PROJECT_HOME</span>/k9mail/build/outputs/apk
<span class="org-keyword">if</span> [ <span class="org-negation-char">!</span> -f k9mail-debug.apk ]; <span class="org-keyword">then</span>
    <span class="org-builtin">echo</span> <span class="org-string">'k9mail-debug.apk was not found'</span>
    <span class="org-keyword">exit</span> -3
<span class="org-keyword">fi</span>
<span class="org-builtin">echo</span> <span class="org-string">'Build script ended successfully'</span>
<span class="org-builtin">echo</span> -n <span class="org-string">'apk is available at: '</span>
<span class="org-builtin">echo</span> <span class="org-string">"$PROJECT_HOME/k9mail/build/outputs/apk/k9mail-debug.apk"</span>
<span class="org-keyword">exit</span> 0
</pre>
</div>

<p>
Save and exit with <b>CTRL-o</b>, <b>CTRL-x</b>.
</p>

<div class="org-src-container">
<pre class="src src-bash">chmod +x build.sh
./build.sh
</pre>
</div>
</div>
</div>

<div id="outline-container-org07edce2" class="outline-4">
<h4 id="org07edce2">Import your GPG key into OpenKeychain</h4>
<div class="outline-text-4" id="text-org07edce2">
<p>
With your device connected to a laptop via USB cable and with USB debugging enabled on it:
</p>

<div class="org-src-container">
<pre class="src src-bash">ssh username@domainname -p 2222
gpg --list-keys username@domainname
gpg --output ~/public_key.gpg --armor --export KEY_ID
gpg --output ~/private_key.gpg --armor --export-secret-key KEY_ID
cat ~/public_key.gpg ~/private_key.gpg &gt; ~/mygpgkey.asc
<span class="org-keyword">exit</span>
scp -P 2222 username@domainname:/home/username/mygpgkey.asc ~/
sudo apt-get install android-tools-adb
push ~/mygpgkey.asc /sdcard/
shred -zu ~/mygpgkey.asc
</pre>
</div>

<p>
Then on your device select OpenKeychain and import your key from file.
</p>
</div>
</div>
<div id="outline-container-orgc17196e" class="outline-4">
<h4 id="orgc17196e">Incoming server settings</h4>
<div class="outline-text-4" id="text-orgc17196e">
<ul class="org-ul">
<li>Select settings/account settings</li>
<li>Select Fetching mail/incoming server</li>
<li>Enter your username and password</li>
<li>IMAP server should be your domain name</li>
<li>Security: SSL/TLS (always)</li>
<li>Authentication: Plain</li>
<li>Port: 993</li>
</ul>
</div>
</div>
<div id="outline-container-org9f01618" class="outline-4">
<h4 id="org9f01618">Outgoing (SMTP) server settings</h4>
<div class="outline-text-4" id="text-org9f01618">
<ul class="org-ul">
<li>Select settings/account settings</li>
<li>Select Sending mail/outgoing server</li>
<li>Set SMTP server to your domain name</li>
<li>Set Security to SSL/TLS (always)</li>
<li>Set port to 465</li>
<li>Set authentication to PLAIN</li>
<li>Enter your username and password</li>
<li>Accept the SSL certificate</li>
</ul>
</div>
</div>
<div id="outline-container-orgcdec2d3" class="outline-4">
<h4 id="orgcdec2d3">Crypto settings</h4>
<div class="outline-text-4" id="text-orgcdec2d3">
<p>
Select <b>settings</b>, <b>Account settings</b>, <b>OpenKeychain</b> and then select your key and press <b>Allow</b>. You should now be able to decrypt emails by entering your GPG passphrase.
</p>

<p>
You may also want to change the amount of time for which passwords are remembered, so that you don't need to enter your passphrase very often.
</p>
</div>
</div>
<div id="outline-container-org5f78e77" class="outline-4">
<h4 id="org5f78e77">Folders</h4>
<div class="outline-text-4" id="text-org5f78e77">
<p>
To view any new folders which you may have created using the <i>mailinglistrule</i> script from your inbox press the <b>K9 icon</b> at the top left to access folders, then press the <b>menu button</b> and select <b>refresh folder list</b>.
</p>

<p>
If your folder still doesn't show up then press the <b>menu button</b>, select <b>show folders</b> and select <b>all folders</b>.
</p>
</div>
</div>
</div>

<div id="outline-container-orge7d90d2" class="outline-2">
<h2 id="orge7d90d2">Subscribing to mailing lists</h2>
<div class="outline-text-2" id="text-orge7d90d2">
<p>
To subscribe to a mailing list log in as your user (i.e. not the root user).
</p>

<div class="org-src-container">
<pre class="src src-bash">ssh username@domainname -p 2222
</pre>
</div>

<p>
Select <i>Administrator controls</i> then <b>Email filtering rules</b> then <b>Add a user to a mailing list</b>. If you want to do it purely from the commandline then see the manpage for <b>freedombone-addlist</b>.
</p>
</div>
</div>
<div id="outline-container-org7a22eb8" class="outline-2">
<h2 id="org7a22eb8">Adding email addresses to a group/folder</h2>
<div class="outline-text-2" id="text-org7a22eb8">
<p>
Similar to adding mailing list folders you can also add specified email addresses into a group/folder.
</p>

<div class="org-src-container">
<pre class="src src-bash">ssh username@domainname -p 2222
</pre>
</div>

<p>
Select <i>Administrator controls</i> then <b>Email filtering rules</b> then <b>Add email rule</b>. To do the same from the commandline see the manpage for <b>freedombone-addemail</b>.
</p>
</div>
</div>
<div id="outline-container-orgf579e55" class="outline-2">
<h2 id="orgf579e55">Ignoring incoming emails</h2>
<div class="outline-text-2" id="text-orgf579e55">
<p>
It is possible to ignore incoming emails if they are from a particular email address or if the subject line contains particular text.
</p>

<div class="org-src-container">
<pre class="src src-bash">ssh username@domainname -p 2222
</pre>
</div>

<p>
Select <i>Administrator controls</i> then <b>Email filtering rules</b> then <b>Block/Unblock and email address</b> or <b>Block/Unblock email with subject line</b>. Also see the manpage for <b>freedombone-ignore</b>.
</p>
</div>
</div>
<div id="outline-container-orgf2e8d68" class="outline-2">
<h2 id="orgf2e8d68">Your own mailing list</h2>
<div class="outline-text-2" id="text-orgf2e8d68">
<p>
If you want to set up a public mailing list then when installing the system remember to set the <b>PUBLIC_MAILING_LIST</b> variable within <b>freedombone.cfg</b> to the name of your list. The name should have no spaces in it. Public mailing lists are unencrypted so anyone will be able to read the contents, including non subscribers.
</p>

<p>
To subscribe to your list send a cleartext email to:
</p>

<div class="org-src-container">
<pre class="src src-bash">mymailinglistname+subscribe@domainname
</pre>
</div>

<p>
Tip: When using the Mutt email client if you want to send an email in cleartext then press <b>p</b> (for PGP) on the sending screen and select <b>clear</b>. Unsecure email is treated as being the exception rather than the default.
</p>

<center>
Return to the <a href="index.html">home page</a>
</center>
</div>
</div>
</div>
<div id="postamble" class="status">

<style type="text/css">
.back-to-top {
    position: fixed;
    bottom: 2em;
    right: 0px;
    text-decoration: none;
    color: #000000;
    background-color: rgba(235, 235, 235, 0.80);
    font-size: 12px;
    padding: 1em;
    display: none;
}

.back-to-top:hover {
    background-color: rgba(135, 135, 135, 0.50);
}
</style>

<div class="back-to-top">
<a href="#top">Back to top</a> | <a href="mailto:bob@freedombone.net">E-mail me</a>
</div>
</div>
</body>
</html>
