<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Freedombone</title>
<!-- 2018-09-12 Wed 12:12 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Bob Mottram" />
<meta  name="description" content="Freedombone developers guide"
 />
<meta  name="keywords" content="freedombone, developers" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="freedombone.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<a name="top" id="top"></a>
</div>
<div id="content">
<h1 class="title">Freedombone</h1>

<div class="figure">
<p><img src="images/logo.png" alt="logo.png" width="80%" height="10%" align="center" />
</p>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Developers Guide</h2>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Introduction</h2>
<div class="outline-text-2" id="text-2">
<p>
Freedombone consists of a set of bash scripts. There are a lot of them, but they're not very complicated. If you're familiar with the GNU/Linux commandline and can hack a bash script then you can probably add a new app or fix a bug in the system. There are no trendy development frameworks to learn or to get in your way. You might also want to consult the <a href="./codeofconduct.html">Code of Conduct</a>, and there is a Matrix room at <b>#fbone:matrix.freedombone.net</b> and an XMPP multi-user chat at <b>support@chat.freedombone.net</b>
</p>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Source code</h2>
<div class="outline-text-2" id="text-3">
<p>
If you just want to take a look at the source code then it can be <a href="https://code.freedombone.net/bashrc/freedombone">found here</a> or is obtainable on dat://e9cbf606e55cdaa85199f4e6ec25ff7456775389979a668b3faf33e057493f8e/
</p>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Creating images</h2>
<div class="outline-text-2" id="text-4">
<p>
Images are an easy way of distributing the software in a manner which avoids problems. These instructions assume that you're running either a Debian or Arch based distro.
</p>

<div class="org-src-container">

<pre class="src src-bash">sudo apt-get install git build-essential dialog
git clone https://code.freedombone.net/bashrc/freedombone
cd freedombone
git checkout stretch
sudo make install
</pre>
</div>

<p>
Then install packages needed for building images:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-image --setup debian
</pre>
</div>

<p>
or on an Arch/Parabola system:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-image --setup parabola
</pre>
</div>

<p>
A typical use case to build an 8GB image for a Beaglebone Black is as follows. You can change the size depending upon the capacity of your microSD card.
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-image -t beagleboneblack -s 8G
</pre>
</div>

<p>
If you prefer an advanced installation with all of the options available then use:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-image -t beagleboneblack -s 8G --minimal no
</pre>
</div>

<p>
To build a 64bit Qemu image:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-image -t qemu-x86_64 -s 8G
</pre>
</div>

<p>
Other supported boards are <b>beaglebonegreen, beaglex15, cubieboard2, cubietruck, pcduino3, a20-olinuxino-lime, a20-olinuxino-lime2, a20-olinuxino-micro, banana-pro, i386, amd64, apu and qemu-i386</b>.
</p>

<p>
If the image build fails with an error such as "<i>Error reading from server. Remote end closed connection</i>" then you can specify a debian package mirror repository manually with:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-image -t beagleboneblack -s 8G -m http://ftp.de.debian.org/debian
</pre>
</div>

<p>
Sometimes the build will fail just because a repo is temporarily unavailable. In that case just trying again may work.
</p>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Adding extra apps</h2>
<div class="outline-text-2" id="text-5">
<p>
Suppose you have some internet application which you want to add to the system. To do this you need to create an app script which tells the system how to install/remove and also backup/restore. The script should be designed to work with the current stable version of Debian.
</p>

<p>
There's a command which you can use to generate scripts for new apps. Some examples are as follows:
</p>

<p>
To create a script for a generic PHP plus MySql/MariaDB web app with a couple of extra packages:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-template --app [name] -e [email] -r [repo url] \
                     --packages "cowsay libssl-dev" \
                     -c [commit] --php yes -d mariadb &gt; \
                     src/freedombone-app-myappname
</pre>
</div>

<p>
For a Nodejs app with MySql/MariaDB database:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-template --app [name] -e [email] -r [repo url] \
                     -c [commit] --node yes -d mariadb \
                     --dir /etc/myappname --daemon yes &gt; \
                     src/freedombone-app-myappname
</pre>
</div>

<p>
For a Python app with Postgresql database:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-template --app [name] -e [email] -r [repo url] \
                     -c [commit] -d postgresql \
                     --dir /etc/myappname --daemon yes &gt; \
                     src/freedombone-app-myappname
</pre>
</div>

<p>
For a Python app without any database, communicating between the daemon and the web server on port 1234:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-template --app [name] -e [email] -r [repo url] \
                     -c [commit] --dir /etc/myappname \
                     --daemon yes --portinternal 1234 &gt; \
                     src/freedombone-app-myappname
</pre>
</div>

<p>
For an app without any database which communicates directly on a particular port through the firewall:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-template --app [name] -e [email] -r [repo url] \
                     -c [commit] --dir /etc/myappname \
                     --daemon yes --port 5000 &gt; \
                     src/freedombone-app-myappname
</pre>
</div>

<p>
A generic PHP plus MySql/MariaDB web app which is only available on an onion address:
</p>

<div class="org-src-container">

<pre class="src src-bash">freedombone-template --app [name] -e [email] -r [repo url] \
                     -c [commit] --php yes -d mariadb \
                     --onion yes &gt; \
                     src/freedombone-app-myappname
</pre>
</div>

<p>
For more details see the manpage:
</p>

<div class="org-src-container">

<pre class="src src-bash">man freedombone-template
</pre>
</div>

<p>
The template command won't give you a fully working app, but it will give you a big head start and avoid a lot of potential mistakes. It's highly likely that you'll still need to add extra configuration for your particular app, especially within the <b>install_app</b> function.
</p>

<p>
When your new script is ready for testing you can install it with:
</p>

<div class="org-src-container">

<pre class="src src-bash">make install
</pre>
</div>

<p>
Then run the administrator control panel and you should see the new app within <b>Add/Remove apps</b>.
</p>

<p>
Submit your working app to <b><a href="https://code.freedombone.net/bashrc/freedombone/issues">https://code.freedombone.net/bashrc/freedombone/issues</a></b>, create a pull request or if you don't have an account there you can send patches via email to bob@freedombone.net.
</p>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">Customising mesh images</h2>
<div class="outline-text-2" id="text-6">
<p>
If you want to make your own specially branded version of the mesh images, such as for a particular event, then to change the default desktop backgrounds edit the images within <b>img/backgrounds</b> and to change the available avatars and desktop icons edit the images within <b>img/avatars</b>. Re-create disk images using the instructions shown previously.
</p>

<p>
If you need particular <i>dconf</i> commands to alter desktop appearance or behavior then see the function <i>mesh_client_startup_applications</i> within <b>src/freedombone-image-customise</b>.
</p>



<div class="figure">
<p><a href="fdl-1.3.txt" width="10%" height="2%" align="center"><img src="images/gfdl.png" alt="gfdl.png" width="10%" height="2%" align="center" /></a>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<style type="text/css">
.back-to-top {
    position: fixed;
    bottom: 2em;
    right: 0px;
    text-decoration: none;
    color: #000000;
    background-color: rgba(235, 235, 235, 0.80);
    font-size: 12px;
    padding: 1em;
    display: none;
}

.back-to-top:hover {
    background-color: rgba(135, 135, 135, 0.50);
}
</style>

<div class="back-to-top">
<a href="#top">Back to top</a> | <a href="mailto:bob@freedombone.net">E-mail me</a>
</div>
</div>
</body>
</html>
